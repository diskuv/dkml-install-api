<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Dkml_package_console_common (dkml-package-console.Dkml_package_console_common)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">dkml-package-console</a> &#x00BB; Dkml_package_console_common</nav><header class="odoc-preamble"><h1>Module <code><span>Dkml_package_console_common</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#error-handling">Error Handling</a></li><li><a href="#author-supplied-types">Author Supplied Types</a></li><li><a href="#running-programs">Running Programs</a></li><li><a href="#installation-paths">Installation Paths</a></li><li><a href="#command-line-processing">Command Line Processing</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec value" id="val-console_component_name" class="anchored"><a href="#val-console_component_name" class="anchor"></a><code><span><span class="keyword">val</span> console_component_name : string</span></code></div><div class="spec-doc"><p><code>console_component_name</code> is the name of the component that has executables that help run console installers (like gsudo.exe on Windows to elevate privileges).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-needs_install_admin" class="anchored"><a href="#val-needs_install_admin" class="anchor"></a><code><span><span class="keyword">val</span> needs_install_admin : 
  <span>reg:<a href="../../dkml-install/Dkml_install_register/Component_registry/index.html#type-t">Dkml_install_register.Component_registry.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>selector:<a href="../../dkml-install/Dkml_install_register/Component_registry/index.html#type-component_selector">Dkml_install_register.Component_registry.component_selector</a> <span class="arrow">&#45;&gt;</span></span>
  <span>log_config:<a href="../../dkml-install/Dkml_install_api/Log_config/index.html#type-t">Dkml_install_api.Log_config.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>target_abi:<a href="../../dkml-install/Dkml_install_api/Context/Abi_v2/index.html#type-t">Dkml_install_api.Context.Abi_v2.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>prefix:<span class="xref-unresolved">Fpath</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span>staging_files_source:<a href="../../dkml-install-runner/Dkml_install_runner/Path_location/index.html#type-staging_files_source">Dkml_install_runner.Path_location.staging_files_source</a> <span class="arrow">&#45;&gt;</span></span>
  <span>bool <a href="../../dkml-install/Dkml_install_api/Forward_progress/index.html#type-t">Dkml_install_api.Forward_progress.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-needs_uninstall_admin" class="anchored"><a href="#val-needs_uninstall_admin" class="anchor"></a><code><span><span class="keyword">val</span> needs_uninstall_admin : 
  <span>reg:<a href="../../dkml-install/Dkml_install_register/Component_registry/index.html#type-t">Dkml_install_register.Component_registry.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>selector:<a href="../../dkml-install/Dkml_install_register/Component_registry/index.html#type-component_selector">Dkml_install_register.Component_registry.component_selector</a> <span class="arrow">&#45;&gt;</span></span>
  <span>log_config:<a href="../../dkml-install/Dkml_install_api/Log_config/index.html#type-t">Dkml_install_api.Log_config.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>target_abi:<a href="../../dkml-install/Dkml_install_api/Context/Abi_v2/index.html#type-t">Dkml_install_api.Context.Abi_v2.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>prefix:<span class="xref-unresolved">Fpath</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span>staging_files_source:<a href="../../dkml-install-runner/Dkml_install_runner/Path_location/index.html#type-staging_files_source">Dkml_install_runner.Path_location.staging_files_source</a> <span class="arrow">&#45;&gt;</span></span>
  <span>bool <a href="../../dkml-install/Dkml_install_api/Forward_progress/index.html#type-t">Dkml_install_api.Forward_progress.t</a></span></span></code></div></div><h2 id="error-handling"><a href="#error-handling" class="anchor"></a>Error Handling</h2><div class="odoc-spec"><div class="spec value" id="val-get_ok_or_failwith_string" class="anchored"><a href="#val-get_ok_or_failwith_string" class="anchor"></a><code><span><span class="keyword">val</span> get_ok_or_failwith_string : <span><span><span>( <span class="type-var">'a</span>, string )</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-get_ok_or_failwith_rresult" class="anchored"><a href="#val-get_ok_or_failwith_rresult" class="anchor"></a><code><span><span class="keyword">val</span> get_ok_or_failwith_rresult : <span><span><span>( <span class="type-var">'a</span>, <span class="xref-unresolved">Rresult</span>.R.msg )</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-box_err" class="anchored"><a href="#val-box_err" class="anchor"></a><code><span><span class="keyword">val</span> box_err : <span>string <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div></div><h2 id="author-supplied-types"><a href="#author-supplied-types" class="anchor"></a>Author Supplied Types</h2><div class="odoc-spec"><div class="spec type" id="type-program_name" class="anchored"><a href="#type-program_name" class="anchor"></a><code><span><span class="keyword">type</span> program_name</span><span> = </span><span>{</span></code><table><tr id="type-program_name.name_full" class="anchored"><td class="def record field"><a href="#type-program_name.name_full" class="anchor"></a><code><span>name_full : string;</span></code></td></tr><tr id="type-program_name.name_camel_case_nospaces" class="anchored"><td class="def record field"><a href="#type-program_name.name_camel_case_nospaces" class="anchor"></a><code><span>name_camel_case_nospaces : string;</span></code></td></tr><tr id="type-program_name.name_kebab_lower_case" class="anchored"><td class="def record field"><a href="#type-program_name.name_kebab_lower_case" class="anchor"></a><code><span>name_kebab_lower_case : string;</span></code></td></tr><tr id="type-program_name.installation_prefix_camel_case_nospaces_opt" class="anchored"><td class="def record field"><a href="#type-program_name.installation_prefix_camel_case_nospaces_opt" class="anchor"></a><code><span>installation_prefix_camel_case_nospaces_opt : <span>string option</span>;</span></code></td></tr><tr id="type-program_name.installation_prefix_kebab_lower_case_opt" class="anchored"><td class="def record field"><a href="#type-program_name.installation_prefix_kebab_lower_case_opt" class="anchor"></a><code><span>installation_prefix_kebab_lower_case_opt : <span>string option</span>;</span></code></td></tr></table><code><span>}</span></code></div><div class="spec-doc"><p>The type of program names.</p><p><code>name_full</code> - Examples include &quot;Diskuv OCaml&quot;</p><p><code>name_camel_case_nospaces</code> - If the program name was &quot;Diskuv OCaml&quot; then the <code>name_camel_case_nospaces</code> could be either &quot;DiskuvOCaml&quot; or &quot;DiskuvOcaml&quot;.</p><p><code>name_kebab_lower_case</code> - If the program name was &quot;Diskuv OCaml&quot; then the <code>name_kebab_lower_case</code> would be &quot;diskuv-ocaml&quot;.</p><p><code>installation_prefix_camel_case_nospaces_opt</code> - The name used when constructing an installation prefix that takes a CamelCase with no spaces. If not specified, then <code>name_camel_case_nospaces</code> is used.</p><p><code>installation_prefix_kebab_lower_case_opt</code> - The name used when constructing an installation prefix that takes a kebab-lower-case. If not specified, then <code>name_kebab_lower_case</code> is used.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-organization" class="anchored"><a href="#type-organization" class="anchor"></a><code><span><span class="keyword">type</span> organization</span><span> = </span><span>{</span></code><table><tr id="type-organization.legal_name" class="anchored"><td class="def record field"><a href="#type-organization.legal_name" class="anchor"></a><code><span>legal_name : string;</span></code></td></tr><tr id="type-organization.common_name_full" class="anchored"><td class="def record field"><a href="#type-organization.common_name_full" class="anchor"></a><code><span>common_name_full : string;</span></code></td></tr><tr id="type-organization.common_name_camel_case_nospaces" class="anchored"><td class="def record field"><a href="#type-organization.common_name_camel_case_nospaces" class="anchor"></a><code><span>common_name_camel_case_nospaces : string;</span></code></td></tr><tr id="type-organization.common_name_kebab_lower_case" class="anchored"><td class="def record field"><a href="#type-organization.common_name_kebab_lower_case" class="anchor"></a><code><span>common_name_kebab_lower_case : string;</span></code></td></tr></table><code><span>}</span></code></div><div class="spec-doc"><p>Details about the organization for signing binaries.</p><p><code>legal_name</code> - Examples include &quot;Diskuv, Inc.&quot;</p><p><code>common_name_full</code> - Examples include &quot;Dow Jones&quot;</p><p><code>common_name_camel_case_nospaces</code> - If the common name was &quot;Dow Jones&quot; then the <code>common_name_camel_case_nospaces</code> would be &quot;DowJones&quot;.</p><p><code>common_name_kebab_lower_case</code> - If the program name was &quot;Dow Jones&quot; then the <code>common_name_kebab_lower_case</code> would be &quot;dow-jones&quot;.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-version_m_n_o_p" class="anchored"><a href="#val-version_m_n_o_p" class="anchor"></a><code><span><span class="keyword">val</span> version_m_n_o_p : <span>string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>ver_m_n_o_p ver</code> converts the version <code>ver</code> into the <code>&quot;mmmmm.nnnnn.ooooo.ppppp&quot;</code> format required by an Application Manifest.</p><p>Confer https://docs.microsoft.com/en-us/windows/win32/sbscs/application-manifests#assemblyidentity</p></div></div><h2 id="running-programs"><a href="#running-programs" class="anchor"></a>Running Programs</h2><div class="odoc-spec"><div class="spec value" id="val-spawn" class="anchored"><a href="#val-spawn" class="anchor"></a><code><span><span class="keyword">val</span> spawn : <span><span class="xref-unresolved">Bos</span>.Cmd.t <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="../../dkml-install/Dkml_install_api/Forward_progress/index.html#type-t">Dkml_install_api.Forward_progress.t</a></span></span></code></div><div class="spec-doc"><p><code>spawn cmd</code> launches the command <code>cmd</code> and waits for its response.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-elevated_cmd" class="anchored"><a href="#val-elevated_cmd" class="anchor"></a><code><span><span class="keyword">val</span> elevated_cmd : 
  <span>target_abi:<a href="../../dkml-install/Dkml_install_api/Context/Abi_v2/index.html#type-t">Dkml_install_api.Context.Abi_v2.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>staging_files_source:<a href="../../dkml-install-runner/Dkml_install_runner/Path_location/index.html#type-staging_files_source">Dkml_install_runner.Path_location.staging_files_source</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Bos</span>.Cmd.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Bos</span>.Cmd.t <a href="../../dkml-install/Dkml_install_api/Forward_progress/index.html#type-t">Dkml_install_api.Forward_progress.t</a></span></span></code></div><div class="spec-doc"><p><code>elevated_cmd ~target_abi ~staging_files_source cmd</code> translates the command <code>cmd</code> into a command that elevates privileges using <code>&quot;gsudo.exe&quot;</code> from the staging files <code>staging_files_source</code> on Windows machines, or <code>&quot;doas&quot;</code>, <code>&quot;sudo&quot;</code> or <code>&quot;su&quot;</code> on the PATH on Unix machines.</p></div></div><h2 id="installation-paths"><a href="#installation-paths" class="anchor"></a>Installation Paths</h2><div class="odoc-spec"><div class="spec value" id="val-get_user_installation_prefix" class="anchored"><a href="#val-get_user_installation_prefix" class="anchor"></a><code><span><span class="keyword">val</span> get_user_installation_prefix : 
  <span>program_name:<a href="#type-program_name">program_name</a> <span class="arrow">&#45;&gt;</span></span>
  <span>target_abi:<span class="xref-unresolved">Dkml_install_api__Types.Context.Abi_v2.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span>prefix_opt:<span>string option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Fpath</span>.t <a href="../../dkml-install/Dkml_install_api/Forward_progress/index.html#type-t">Dkml_install_api.Forward_progress.t</a></span></span></code></div><div class="spec-doc"><p><code>get_user_installation_prefix ~program_name ~target_abi ~prefix_opt</code> returns where user programs should be installed; either the prefix <code>prefix_opt = Some prefix</code> or uses the platform convention when <code>prefix_opt = None</code>.</p><p>Platform Conventions</p><p>The user programs would be installed to these locations by default:</p><p>Windows: <code>&quot;$env:LOCALAPPDATA\\Programs\\&lt;name_full&gt;&quot;</code> when <code>prefer_spaces = False</code> or <code>&quot;$env:LOCALAPPDATA\\Programs\\&lt;name_camel_case_nospaces&gt;&quot;</code> otherwise. This pattern closely conforms to the standard established by <code>&quot;$env:LOCALAPPDATA\\Programs\\Microsoft VS Code&quot;</code></p><p>macOS: <code>&quot;~/Applications/&lt;name_full&gt;.app&quot;</code> when <code>prefer_spaces = False</code> or <code>&quot;~/Applications/&lt;name_camel_case_nospaces&gt;.app&quot;</code> otherwise.</p><p>Linux: If <code>&quot;$XDG_DATA_HOME&quot;</code> is defined then <code>&quot;$XDG_DATA_HOME/&lt;name_kebab_lower_case&gt;&quot;</code> otherwise <code>&quot;$HOME/.local/share/&lt;name_kebab_lower_case&gt;&quot;</code></p></div></div><h2 id="command-line-processing"><a href="#command-line-processing" class="anchor"></a>Command Line Processing</h2><div class="odoc-spec"><div class="spec type" id="type-package_args" class="anchored"><a href="#type-package_args" class="anchor"></a><code><span><span class="keyword">type</span> package_args</span><span> = </span><span>{</span></code><table><tr id="type-package_args.log_config" class="anchored"><td class="def record field"><a href="#type-package_args.log_config" class="anchor"></a><code><span>log_config : <a href="../../dkml-install/Dkml_install_api/Log_config/index.html#type-t">Dkml_install_api.Log_config.t</a>;</span></code></td></tr><tr id="type-package_args.prefix_opt" class="anchored"><td class="def record field"><a href="#type-package_args.prefix_opt" class="anchor"></a><code><span>prefix_opt : <span>string option</span>;</span></code></td></tr><tr id="type-package_args.component_selector" class="anchored"><td class="def record field"><a href="#type-package_args.component_selector" class="anchor"></a><code><span>component_selector : <span>string list</span>;</span></code></td></tr><tr id="type-package_args.static_files_source" class="anchored"><td class="def record field"><a href="#type-package_args.static_files_source" class="anchor"></a><code><span>static_files_source : <a href="../../dkml-install-runner/Dkml_install_runner/Path_location/index.html#type-static_files_source">Dkml_install_runner.Path_location.static_files_source</a>;</span></code></td></tr><tr id="type-package_args.staging_files_source" class="anchored"><td class="def record field"><a href="#type-package_args.staging_files_source" class="anchor"></a><code><span>staging_files_source : <a href="../../dkml-install-runner/Dkml_install_runner/Path_location/index.html#type-staging_files_source">Dkml_install_runner.Path_location.staging_files_source</a>;</span></code></td></tr></table><code><span>}</span></code></div><div class="spec-doc"><p>Common options between setup.exe and uninstaller.exe</p></div></div><div class="odoc-spec"><div class="spec value" id="val-package_args_t" class="anchored"><a href="#val-package_args_t" class="anchor"></a><code><span><span class="keyword">val</span> package_args_t : 
  <span>program_name:<a href="#type-program_name">program_name</a> <span class="arrow">&#45;&gt;</span></span>
  <span>target_abi:<span class="xref-unresolved">Dkml_install_api__Types.Context.Abi_v2.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-package_args">package_args</a> <span class="xref-unresolved">Cmdliner</span>.Term.t</span></span></code></div><div class="spec-doc"><p><code>Cmdliner</code>.Term.t for the common options between setup.exe and uninstaller.exe</p></div></div></div></body></html>